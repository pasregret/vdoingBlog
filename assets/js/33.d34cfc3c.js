(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{341:function(t,a){t.exports="data:image/png;base64,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"},461:function(t,a,A){"use strict";A.r(a);var r=A(11),e=Object(r.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"lucene-和-es-的前世今生"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lucene-和-es-的前世今生"}},[t._v("#")]),t._v(" Lucene 和 ES 的前世今生")]),t._v(" "),a("p",[t._v("Lucene 是最先进、功能最强大的搜索库。如果直接基于 Lucene 开发，非常复杂，即便写一些简单的功能，也要写大量的 Java 代码，需要深入理解原理。")]),t._v(" "),a("p",[t._v("ElasticSearch 基于 Lucene，隐藏了 lucene 的复杂性，提供了简单易用的 RESTful api / Java api 接口（另外还有其他语言的 api 接口）。")]),t._v(" "),a("ul",[a("li",[t._v("分布式的文档存储引擎")]),t._v(" "),a("li",[t._v("分布式的搜索引擎和分析引擎")]),t._v(" "),a("li",[t._v("分布式，支持 PB 级数据")])]),t._v(" "),a("h2",{attrs:{id:"es-的核心概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#es-的核心概念"}},[t._v("#")]),t._v(" ES 的核心概念")]),t._v(" "),a("h3",{attrs:{id:"near-realtime"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#near-realtime"}},[t._v("#")]),t._v(" Near Realtime")]),t._v(" "),a("p",[t._v("近实时，有两层意思：")]),t._v(" "),a("ul",[a("li",[t._v("从写入数据到数据可以被搜索到有一个小延迟（大概是 1s）")]),t._v(" "),a("li",[t._v("基于 ES 执行搜索和分析可以达到秒级")])]),t._v(" "),a("h3",{attrs:{id:"cluster-集群"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cluster-集群"}},[t._v("#")]),t._v(" Cluster 集群")]),t._v(" "),a("p",[t._v("集群包含多个节点，每个节点属于哪个集群都是通过一个配置来决定的，对于中小型应用来说，刚开始一个集群就一个节点很正常。")]),t._v(" "),a("h3",{attrs:{id:"node-节点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#node-节点"}},[t._v("#")]),t._v(" Node 节点")]),t._v(" "),a("p",[t._v("Node 是集群中的一个节点，节点也有一个名称，默认是随机分配的。默认节点会去加入一个名称为 "),a("code",[t._v("elasticsearch")]),t._v(" 的集群。如果直接启动一堆节点，那么它们会自动组成一个 elasticsearch 集群，当然一个节点也可以组成 elasticsearch 集群。")]),t._v(" "),a("h3",{attrs:{id:"document-field"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#document-field"}},[t._v("#")]),t._v(" Document & field")]),t._v(" "),a("p",[t._v("文档是 ES 中最小的数据单元，一个 document 可以是一条客户数据、一条商品分类数据、一条订单数据，通常用 json 数据结构来表示。每个 index 下的 type，都可以存储多条 document。一个 document 里面有多个 field，每个 field 就是一个数据字段。")]),t._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"product_id"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"product_name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"iPhone X"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"product_desc"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"苹果手机"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"category_id"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"category_name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"电子产品"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("h3",{attrs:{id:"index"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#index"}},[t._v("#")]),t._v(" Index")]),t._v(" "),a("p",[t._v("索引包含了一堆有相似结构的文档数据，比如商品索引。一个索引包含很多 document，一个索引就代表了一类相似或者相同的 document。")]),t._v(" "),a("h3",{attrs:{id:"type"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#type"}},[t._v("#")]),t._v(" Type")]),t._v(" "),a("p",[t._v("类型，每个索引里可以有一个或者多个 type，type 是 index 的一个逻辑分类，比如商品 index 下有多个 type：日化商品 type、电器商品 type、生鲜商品 type。每个 type 下的 document 的 field 可能不太一样。")]),t._v(" "),a("h3",{attrs:{id:"shard"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#shard"}},[t._v("#")]),t._v(" shard")]),t._v(" "),a("p",[t._v("单台机器无法存储大量数据，ES 可以将一个索引中的数据切分为多个 shard，分布在多台服务器上存储。有了 shard 就可以横向扩展，存储更多数据，让搜索和分析等操作分布到多台服务器上去执行，提升吞吐量和性能。每个 shard 都是一个 lucene index。")]),t._v(" "),a("h3",{attrs:{id:"replica"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#replica"}},[t._v("#")]),t._v(" replica")]),t._v(" "),a("p",[t._v("任何一个服务器随时可能故障或宕机，此时 shard 可能就会丢失，因此可以为每个 shard 创建多个 replica 副本。replica 可以在 shard 故障时提供备用服务，保证数据不丢失，多个 replica 还可以提升搜索操作的吞吐量和性能。primary shard（建立索引时一次设置，不能修改，默认 5 个），replica shard（随时修改数量，默认 1 个），默认每个索引 10 个 shard，5 个 primary shard，5 个 replica shard，最小的高可用配置，是 2 台服务器。")]),t._v(" "),a("p",[t._v("这么说吧，shard 分为 primary shard 和 replica shard。而 primary shard 一般简称为 shard，而 replica shard 一般简称为 replica。")]),t._v(" "),a("p",[a("img",{attrs:{src:A(341),alt:"es-cluster-0"}})]),t._v(" "),a("h2",{attrs:{id:"es-核心概念-vs-db-核心概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#es-核心概念-vs-db-核心概念"}},[t._v("#")]),t._v(" ES 核心概念 vs. DB 核心概念")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("ES")]),t._v(" "),a("th",[t._v("DB")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("index")]),t._v(" "),a("td",[t._v("数据库")])]),t._v(" "),a("tr",[a("td",[t._v("type")]),t._v(" "),a("td",[t._v("数据表")])]),t._v(" "),a("tr",[a("td",[t._v("document")]),t._v(" "),a("td",[t._v("一行数据")])])])]),t._v(" "),a("p",[t._v("以上是一个简单的类比。")])])}),[],!1,null,null,null);a.default=e.exports}}]);