<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>redis-cluster | 時念</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/vdoingBlog/img/csdn.ico">
    <link rel="stylesheet" href="/vdoingBlog/icon/iconfont.css">
    <meta name="description" content="在努力一点，成为更优秀的人">
    <meta name="keywords" content="全栈博客,个人技术博客,前端,后端开发,后端框架,技术文档,学习,面试,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/vdoingBlog/assets/css/0.styles.1a8a0045.css" as="style"><link rel="preload" href="/vdoingBlog/assets/js/app.b9445f3d.js" as="script"><link rel="preload" href="/vdoingBlog/assets/js/2.6f6622d0.js" as="script"><link rel="preload" href="/vdoingBlog/assets/js/3.2637abc7.js" as="script"><link rel="preload" href="/vdoingBlog/assets/js/5.5bfcaf23.js" as="script"><link rel="prefetch" href="/vdoingBlog/assets/js/10.f47bb344.js"><link rel="prefetch" href="/vdoingBlog/assets/js/100.42845136.js"><link rel="prefetch" href="/vdoingBlog/assets/js/101.f4fa1fb3.js"><link rel="prefetch" href="/vdoingBlog/assets/js/102.3b223ea5.js"><link rel="prefetch" href="/vdoingBlog/assets/js/103.2feef0d7.js"><link rel="prefetch" href="/vdoingBlog/assets/js/104.d8c00bff.js"><link rel="prefetch" href="/vdoingBlog/assets/js/105.20cd0607.js"><link rel="prefetch" href="/vdoingBlog/assets/js/106.001d93be.js"><link rel="prefetch" href="/vdoingBlog/assets/js/107.b8d7babc.js"><link rel="prefetch" href="/vdoingBlog/assets/js/108.910bf8f7.js"><link rel="prefetch" href="/vdoingBlog/assets/js/109.78853843.js"><link rel="prefetch" href="/vdoingBlog/assets/js/11.aa074a37.js"><link rel="prefetch" href="/vdoingBlog/assets/js/110.d242bfec.js"><link rel="prefetch" href="/vdoingBlog/assets/js/111.6a5c9de7.js"><link rel="prefetch" href="/vdoingBlog/assets/js/112.d252eeeb.js"><link rel="prefetch" href="/vdoingBlog/assets/js/113.d9f0ce34.js"><link rel="prefetch" href="/vdoingBlog/assets/js/114.fe4b6af6.js"><link rel="prefetch" href="/vdoingBlog/assets/js/115.e4a474d2.js"><link rel="prefetch" href="/vdoingBlog/assets/js/116.aeca2095.js"><link rel="prefetch" href="/vdoingBlog/assets/js/117.d7dc004d.js"><link rel="prefetch" href="/vdoingBlog/assets/js/118.84bcb9d9.js"><link rel="prefetch" href="/vdoingBlog/assets/js/119.4dfa1c83.js"><link rel="prefetch" href="/vdoingBlog/assets/js/12.5d63e14e.js"><link rel="prefetch" href="/vdoingBlog/assets/js/120.854e657f.js"><link rel="prefetch" href="/vdoingBlog/assets/js/121.6da2d006.js"><link rel="prefetch" href="/vdoingBlog/assets/js/122.c3b31eb5.js"><link rel="prefetch" href="/vdoingBlog/assets/js/123.11d5eecd.js"><link rel="prefetch" href="/vdoingBlog/assets/js/124.7a3b425f.js"><link rel="prefetch" href="/vdoingBlog/assets/js/125.b9e5125a.js"><link rel="prefetch" href="/vdoingBlog/assets/js/126.5c6a319c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/127.c4f91b82.js"><link rel="prefetch" href="/vdoingBlog/assets/js/128.a44c3fa4.js"><link rel="prefetch" href="/vdoingBlog/assets/js/129.f8682a40.js"><link rel="prefetch" href="/vdoingBlog/assets/js/13.a5ee467c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/130.8c1775aa.js"><link rel="prefetch" href="/vdoingBlog/assets/js/131.55c54bc6.js"><link rel="prefetch" href="/vdoingBlog/assets/js/132.7d15b20e.js"><link rel="prefetch" href="/vdoingBlog/assets/js/133.b29cf3ba.js"><link rel="prefetch" href="/vdoingBlog/assets/js/134.314ca301.js"><link rel="prefetch" href="/vdoingBlog/assets/js/135.360ddced.js"><link rel="prefetch" href="/vdoingBlog/assets/js/136.78a4c5a1.js"><link rel="prefetch" href="/vdoingBlog/assets/js/137.940596c3.js"><link rel="prefetch" href="/vdoingBlog/assets/js/138.2ec64349.js"><link rel="prefetch" href="/vdoingBlog/assets/js/139.5a9b5fe5.js"><link rel="prefetch" href="/vdoingBlog/assets/js/14.512fbd60.js"><link rel="prefetch" href="/vdoingBlog/assets/js/140.508c1e62.js"><link rel="prefetch" href="/vdoingBlog/assets/js/141.1cf87c66.js"><link rel="prefetch" href="/vdoingBlog/assets/js/142.d0673700.js"><link rel="prefetch" href="/vdoingBlog/assets/js/143.d931e217.js"><link rel="prefetch" href="/vdoingBlog/assets/js/144.2ba080d0.js"><link rel="prefetch" href="/vdoingBlog/assets/js/145.34a66124.js"><link rel="prefetch" href="/vdoingBlog/assets/js/146.7326184c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/147.9a40c0bc.js"><link rel="prefetch" href="/vdoingBlog/assets/js/148.5a0704ca.js"><link rel="prefetch" href="/vdoingBlog/assets/js/149.50811395.js"><link rel="prefetch" href="/vdoingBlog/assets/js/15.0e6b28e8.js"><link rel="prefetch" href="/vdoingBlog/assets/js/150.ce4936ee.js"><link rel="prefetch" href="/vdoingBlog/assets/js/151.d3b6c741.js"><link rel="prefetch" href="/vdoingBlog/assets/js/152.cf8a427e.js"><link rel="prefetch" href="/vdoingBlog/assets/js/153.67b4278d.js"><link rel="prefetch" href="/vdoingBlog/assets/js/154.696fd65b.js"><link rel="prefetch" href="/vdoingBlog/assets/js/155.fb50bb35.js"><link rel="prefetch" href="/vdoingBlog/assets/js/156.1cfd70cc.js"><link rel="prefetch" href="/vdoingBlog/assets/js/157.2686ced9.js"><link rel="prefetch" href="/vdoingBlog/assets/js/158.2ae25174.js"><link rel="prefetch" href="/vdoingBlog/assets/js/159.7f50d687.js"><link rel="prefetch" href="/vdoingBlog/assets/js/16.d111875a.js"><link rel="prefetch" href="/vdoingBlog/assets/js/160.f6a1a2f6.js"><link rel="prefetch" href="/vdoingBlog/assets/js/161.4de2d7b6.js"><link rel="prefetch" href="/vdoingBlog/assets/js/162.e07ff9e5.js"><link rel="prefetch" href="/vdoingBlog/assets/js/163.b6d85d31.js"><link rel="prefetch" href="/vdoingBlog/assets/js/164.9df7b62a.js"><link rel="prefetch" href="/vdoingBlog/assets/js/165.15094616.js"><link rel="prefetch" href="/vdoingBlog/assets/js/166.4502e212.js"><link rel="prefetch" href="/vdoingBlog/assets/js/167.0082e3a6.js"><link rel="prefetch" href="/vdoingBlog/assets/js/168.a1f1e027.js"><link rel="prefetch" href="/vdoingBlog/assets/js/169.7182c79d.js"><link rel="prefetch" href="/vdoingBlog/assets/js/17.a6b9fe89.js"><link rel="prefetch" href="/vdoingBlog/assets/js/170.419f80a9.js"><link rel="prefetch" href="/vdoingBlog/assets/js/171.067de789.js"><link rel="prefetch" href="/vdoingBlog/assets/js/172.ebcd5f51.js"><link rel="prefetch" href="/vdoingBlog/assets/js/173.6ea25a9e.js"><link rel="prefetch" href="/vdoingBlog/assets/js/174.048ac45b.js"><link rel="prefetch" href="/vdoingBlog/assets/js/175.21ad8213.js"><link rel="prefetch" href="/vdoingBlog/assets/js/176.fc821e09.js"><link rel="prefetch" href="/vdoingBlog/assets/js/177.288a7737.js"><link rel="prefetch" href="/vdoingBlog/assets/js/178.0f0a8e39.js"><link rel="prefetch" href="/vdoingBlog/assets/js/179.5e6de083.js"><link rel="prefetch" href="/vdoingBlog/assets/js/18.6be9a6f0.js"><link rel="prefetch" href="/vdoingBlog/assets/js/180.a2bb75b2.js"><link rel="prefetch" href="/vdoingBlog/assets/js/181.cc9aad01.js"><link rel="prefetch" href="/vdoingBlog/assets/js/182.3be491c0.js"><link rel="prefetch" href="/vdoingBlog/assets/js/183.ff692088.js"><link rel="prefetch" href="/vdoingBlog/assets/js/184.ab527a41.js"><link rel="prefetch" href="/vdoingBlog/assets/js/185.27c47df6.js"><link rel="prefetch" href="/vdoingBlog/assets/js/186.e79580bc.js"><link rel="prefetch" href="/vdoingBlog/assets/js/187.216360af.js"><link rel="prefetch" href="/vdoingBlog/assets/js/188.24cadeb0.js"><link rel="prefetch" href="/vdoingBlog/assets/js/189.da233a87.js"><link rel="prefetch" href="/vdoingBlog/assets/js/19.86f6452b.js"><link rel="prefetch" href="/vdoingBlog/assets/js/190.7f5da3da.js"><link rel="prefetch" href="/vdoingBlog/assets/js/191.8c4fce80.js"><link rel="prefetch" href="/vdoingBlog/assets/js/192.de037120.js"><link rel="prefetch" href="/vdoingBlog/assets/js/193.49af491f.js"><link rel="prefetch" href="/vdoingBlog/assets/js/194.33cd7c3d.js"><link rel="prefetch" href="/vdoingBlog/assets/js/195.d50e2b4a.js"><link rel="prefetch" href="/vdoingBlog/assets/js/196.f4ac2d96.js"><link rel="prefetch" href="/vdoingBlog/assets/js/197.e83bd5da.js"><link rel="prefetch" href="/vdoingBlog/assets/js/198.b746f9b4.js"><link rel="prefetch" href="/vdoingBlog/assets/js/199.287a6928.js"><link rel="prefetch" href="/vdoingBlog/assets/js/20.7ca85149.js"><link rel="prefetch" href="/vdoingBlog/assets/js/200.af57083b.js"><link rel="prefetch" href="/vdoingBlog/assets/js/201.de53962d.js"><link rel="prefetch" href="/vdoingBlog/assets/js/202.e39e4c9e.js"><link rel="prefetch" href="/vdoingBlog/assets/js/203.8a43da34.js"><link rel="prefetch" href="/vdoingBlog/assets/js/204.3b48e56b.js"><link rel="prefetch" href="/vdoingBlog/assets/js/205.58152076.js"><link rel="prefetch" href="/vdoingBlog/assets/js/206.7a570980.js"><link rel="prefetch" href="/vdoingBlog/assets/js/207.522085c9.js"><link rel="prefetch" href="/vdoingBlog/assets/js/208.c169e955.js"><link rel="prefetch" href="/vdoingBlog/assets/js/209.243ad8a0.js"><link rel="prefetch" href="/vdoingBlog/assets/js/21.bba7fcbf.js"><link rel="prefetch" href="/vdoingBlog/assets/js/210.c3553b91.js"><link rel="prefetch" href="/vdoingBlog/assets/js/211.e8a75c3c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/212.199703db.js"><link rel="prefetch" href="/vdoingBlog/assets/js/213.2dea942d.js"><link rel="prefetch" href="/vdoingBlog/assets/js/214.40c70c39.js"><link rel="prefetch" href="/vdoingBlog/assets/js/215.6ddaa777.js"><link rel="prefetch" href="/vdoingBlog/assets/js/216.b8389550.js"><link rel="prefetch" href="/vdoingBlog/assets/js/217.034a8d97.js"><link rel="prefetch" href="/vdoingBlog/assets/js/218.326799dd.js"><link rel="prefetch" href="/vdoingBlog/assets/js/219.1ce05f0c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/22.6a217f79.js"><link rel="prefetch" href="/vdoingBlog/assets/js/220.f4b2b31f.js"><link rel="prefetch" href="/vdoingBlog/assets/js/221.6f4b7e7d.js"><link rel="prefetch" href="/vdoingBlog/assets/js/222.ddfc21ad.js"><link rel="prefetch" href="/vdoingBlog/assets/js/223.3285a573.js"><link rel="prefetch" href="/vdoingBlog/assets/js/224.1887e1cf.js"><link rel="prefetch" href="/vdoingBlog/assets/js/225.d665d7de.js"><link rel="prefetch" href="/vdoingBlog/assets/js/226.d8d88acb.js"><link rel="prefetch" href="/vdoingBlog/assets/js/227.dedbc9b5.js"><link rel="prefetch" href="/vdoingBlog/assets/js/228.9f28147a.js"><link rel="prefetch" href="/vdoingBlog/assets/js/229.5d3f5869.js"><link rel="prefetch" href="/vdoingBlog/assets/js/23.6f37664f.js"><link rel="prefetch" href="/vdoingBlog/assets/js/230.b31887a1.js"><link rel="prefetch" href="/vdoingBlog/assets/js/231.67fec01a.js"><link rel="prefetch" href="/vdoingBlog/assets/js/232.bea7df27.js"><link rel="prefetch" href="/vdoingBlog/assets/js/233.5b3c6857.js"><link rel="prefetch" href="/vdoingBlog/assets/js/234.55f4734c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/235.64aa2ea9.js"><link rel="prefetch" href="/vdoingBlog/assets/js/236.a2b44de4.js"><link rel="prefetch" href="/vdoingBlog/assets/js/237.ce4d1dda.js"><link rel="prefetch" href="/vdoingBlog/assets/js/238.00c4438d.js"><link rel="prefetch" href="/vdoingBlog/assets/js/239.3a6c497a.js"><link rel="prefetch" href="/vdoingBlog/assets/js/24.330545a3.js"><link rel="prefetch" href="/vdoingBlog/assets/js/240.3289617c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/241.44123b24.js"><link rel="prefetch" href="/vdoingBlog/assets/js/242.f6843956.js"><link rel="prefetch" href="/vdoingBlog/assets/js/243.0eb3259e.js"><link rel="prefetch" href="/vdoingBlog/assets/js/244.b456176f.js"><link rel="prefetch" href="/vdoingBlog/assets/js/245.464aa68a.js"><link rel="prefetch" href="/vdoingBlog/assets/js/246.b2fd97f3.js"><link rel="prefetch" href="/vdoingBlog/assets/js/247.01768412.js"><link rel="prefetch" href="/vdoingBlog/assets/js/248.cb33fa7d.js"><link rel="prefetch" href="/vdoingBlog/assets/js/249.d0a22772.js"><link rel="prefetch" href="/vdoingBlog/assets/js/25.2affc905.js"><link rel="prefetch" href="/vdoingBlog/assets/js/250.bbb1d9f8.js"><link rel="prefetch" href="/vdoingBlog/assets/js/251.17732198.js"><link rel="prefetch" href="/vdoingBlog/assets/js/252.67ead1f3.js"><link rel="prefetch" href="/vdoingBlog/assets/js/253.ff7432e4.js"><link rel="prefetch" href="/vdoingBlog/assets/js/254.58f13ff0.js"><link rel="prefetch" href="/vdoingBlog/assets/js/255.96282a6c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/256.16c6996c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/257.11426b0d.js"><link rel="prefetch" href="/vdoingBlog/assets/js/258.fc70ecd1.js"><link rel="prefetch" href="/vdoingBlog/assets/js/259.64662286.js"><link rel="prefetch" href="/vdoingBlog/assets/js/26.7460efa9.js"><link rel="prefetch" href="/vdoingBlog/assets/js/260.be886c6b.js"><link rel="prefetch" href="/vdoingBlog/assets/js/261.25f1bb31.js"><link rel="prefetch" href="/vdoingBlog/assets/js/262.793852d7.js"><link rel="prefetch" href="/vdoingBlog/assets/js/263.4963bbd6.js"><link rel="prefetch" href="/vdoingBlog/assets/js/264.e91dc44c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/265.2e93a9c1.js"><link rel="prefetch" href="/vdoingBlog/assets/js/266.d5ed2010.js"><link rel="prefetch" href="/vdoingBlog/assets/js/267.002129a4.js"><link rel="prefetch" href="/vdoingBlog/assets/js/268.09446f1b.js"><link rel="prefetch" href="/vdoingBlog/assets/js/269.23bf3d9b.js"><link rel="prefetch" href="/vdoingBlog/assets/js/27.8cf99488.js"><link rel="prefetch" href="/vdoingBlog/assets/js/270.dd152eff.js"><link rel="prefetch" href="/vdoingBlog/assets/js/271.38eeda08.js"><link rel="prefetch" href="/vdoingBlog/assets/js/272.41de06d9.js"><link rel="prefetch" href="/vdoingBlog/assets/js/273.b8af50b4.js"><link rel="prefetch" href="/vdoingBlog/assets/js/274.724e5983.js"><link rel="prefetch" href="/vdoingBlog/assets/js/275.713c772c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/276.c7c193c3.js"><link rel="prefetch" href="/vdoingBlog/assets/js/277.893f4cf7.js"><link rel="prefetch" href="/vdoingBlog/assets/js/278.358b4464.js"><link rel="prefetch" href="/vdoingBlog/assets/js/279.41cb7fc2.js"><link rel="prefetch" href="/vdoingBlog/assets/js/28.5e432976.js"><link rel="prefetch" href="/vdoingBlog/assets/js/280.db41c095.js"><link rel="prefetch" href="/vdoingBlog/assets/js/281.bb0b84a9.js"><link rel="prefetch" href="/vdoingBlog/assets/js/282.54b9417c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/29.f7b9a0a6.js"><link rel="prefetch" href="/vdoingBlog/assets/js/30.fce3b883.js"><link rel="prefetch" href="/vdoingBlog/assets/js/31.e0777ef5.js"><link rel="prefetch" href="/vdoingBlog/assets/js/32.025aa98c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/33.d34cfc3c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/34.223f1e50.js"><link rel="prefetch" href="/vdoingBlog/assets/js/35.3d291932.js"><link rel="prefetch" href="/vdoingBlog/assets/js/36.74b28a40.js"><link rel="prefetch" href="/vdoingBlog/assets/js/37.f0702c91.js"><link rel="prefetch" href="/vdoingBlog/assets/js/38.15da7dbf.js"><link rel="prefetch" href="/vdoingBlog/assets/js/39.932b8cb6.js"><link rel="prefetch" href="/vdoingBlog/assets/js/4.a491a05d.js"><link rel="prefetch" href="/vdoingBlog/assets/js/40.e249bf9a.js"><link rel="prefetch" href="/vdoingBlog/assets/js/41.690459ca.js"><link rel="prefetch" href="/vdoingBlog/assets/js/42.5bd5f7f0.js"><link rel="prefetch" href="/vdoingBlog/assets/js/43.f7e5a4b6.js"><link rel="prefetch" href="/vdoingBlog/assets/js/44.5a483a79.js"><link rel="prefetch" href="/vdoingBlog/assets/js/45.c0bc03f5.js"><link rel="prefetch" href="/vdoingBlog/assets/js/46.a5974c35.js"><link rel="prefetch" href="/vdoingBlog/assets/js/47.747acaf5.js"><link rel="prefetch" href="/vdoingBlog/assets/js/48.58258c94.js"><link rel="prefetch" href="/vdoingBlog/assets/js/49.973c09f1.js"><link rel="prefetch" href="/vdoingBlog/assets/js/50.8cf73048.js"><link rel="prefetch" href="/vdoingBlog/assets/js/51.b21c4ce2.js"><link rel="prefetch" href="/vdoingBlog/assets/js/52.93254a3c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/53.62ca680c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/54.b69108ab.js"><link rel="prefetch" href="/vdoingBlog/assets/js/55.91dc99a4.js"><link rel="prefetch" href="/vdoingBlog/assets/js/56.4c7a79d1.js"><link rel="prefetch" href="/vdoingBlog/assets/js/57.83aef27e.js"><link rel="prefetch" href="/vdoingBlog/assets/js/58.54926fb5.js"><link rel="prefetch" href="/vdoingBlog/assets/js/59.c69b7d5a.js"><link rel="prefetch" href="/vdoingBlog/assets/js/6.a1476036.js"><link rel="prefetch" href="/vdoingBlog/assets/js/60.34ba73de.js"><link rel="prefetch" href="/vdoingBlog/assets/js/61.dfad92b5.js"><link rel="prefetch" href="/vdoingBlog/assets/js/62.969e8a20.js"><link rel="prefetch" href="/vdoingBlog/assets/js/63.b8e0f8a2.js"><link rel="prefetch" href="/vdoingBlog/assets/js/64.d8b8bd5e.js"><link rel="prefetch" href="/vdoingBlog/assets/js/65.e5de6837.js"><link rel="prefetch" href="/vdoingBlog/assets/js/66.a26401e1.js"><link rel="prefetch" href="/vdoingBlog/assets/js/67.00210a72.js"><link rel="prefetch" href="/vdoingBlog/assets/js/68.e910883f.js"><link rel="prefetch" href="/vdoingBlog/assets/js/69.4ee7f4d3.js"><link rel="prefetch" href="/vdoingBlog/assets/js/7.97c75439.js"><link rel="prefetch" href="/vdoingBlog/assets/js/70.a460a602.js"><link rel="prefetch" href="/vdoingBlog/assets/js/71.5c33e129.js"><link rel="prefetch" href="/vdoingBlog/assets/js/72.a71d8d18.js"><link rel="prefetch" href="/vdoingBlog/assets/js/73.5742fae2.js"><link rel="prefetch" href="/vdoingBlog/assets/js/74.51cb4883.js"><link rel="prefetch" href="/vdoingBlog/assets/js/75.e88f1ce2.js"><link rel="prefetch" href="/vdoingBlog/assets/js/76.0ba0af41.js"><link rel="prefetch" href="/vdoingBlog/assets/js/77.64546166.js"><link rel="prefetch" href="/vdoingBlog/assets/js/78.6ba65b66.js"><link rel="prefetch" href="/vdoingBlog/assets/js/79.14e24020.js"><link rel="prefetch" href="/vdoingBlog/assets/js/8.a941c0a5.js"><link rel="prefetch" href="/vdoingBlog/assets/js/80.b9cd74eb.js"><link rel="prefetch" href="/vdoingBlog/assets/js/81.f49a364d.js"><link rel="prefetch" href="/vdoingBlog/assets/js/82.7d338240.js"><link rel="prefetch" href="/vdoingBlog/assets/js/83.fcbcdac1.js"><link rel="prefetch" href="/vdoingBlog/assets/js/84.1003ec25.js"><link rel="prefetch" href="/vdoingBlog/assets/js/85.0b8c5902.js"><link rel="prefetch" href="/vdoingBlog/assets/js/86.4e9c3774.js"><link rel="prefetch" href="/vdoingBlog/assets/js/87.8be27033.js"><link rel="prefetch" href="/vdoingBlog/assets/js/88.cdf074e7.js"><link rel="prefetch" href="/vdoingBlog/assets/js/89.8d3f92c1.js"><link rel="prefetch" href="/vdoingBlog/assets/js/9.249dec4c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/90.089c63ac.js"><link rel="prefetch" href="/vdoingBlog/assets/js/91.397865aa.js"><link rel="prefetch" href="/vdoingBlog/assets/js/92.240472ae.js"><link rel="prefetch" href="/vdoingBlog/assets/js/93.2e5c2e33.js"><link rel="prefetch" href="/vdoingBlog/assets/js/94.788d4e86.js"><link rel="prefetch" href="/vdoingBlog/assets/js/95.d69ebc8e.js"><link rel="prefetch" href="/vdoingBlog/assets/js/96.ccf3cb00.js"><link rel="prefetch" href="/vdoingBlog/assets/js/97.a44a6468.js"><link rel="prefetch" href="/vdoingBlog/assets/js/98.f286d274.js"><link rel="prefetch" href="/vdoingBlog/assets/js/99.e3822a1d.js">
    <link rel="stylesheet" href="/vdoingBlog/assets/css/0.styles.1a8a0045.css">
    <style>
      .theme-mode-light:after{background-image: url(https://img.xjh.me/random_img.php?ctype=acg&return=302&type=bg);content: "";background-repeat: no-repeat;background-position: 50%;opacity: .06;-moz-filter: grayscale(100%);-ms-filter: grayscale(100%);-o-filter: grayscale(100%);filter: grayscale(100%);filter: #808080;position: fixed;top: 0;left: 0;width: 100%;height: 100%;z-index: -1;}
      .theme-vdoing-wrapper{letter-spacing: 2px!important;background-image: linear-gradient(90deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%), linear-gradient(360deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%)!important;background-size: 20px 20px!important;background-position: center center!important}
</style>
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vdoingBlog/" class="home-link router-link-active"><img src="/vdoingBlog/img/csdn.png" alt="時念" class="logo"> <span class="site-name can-hide"></span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vdoingBlog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/vdoingBlog/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/pages/802a1ca6f7b71c59/" class="nav-link">Vue</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/note/javascript/" class="nav-link">《JavaScript教程》笔记</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/es6/" class="nav-link">《ES6 教程》笔记</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/vue/" class="nav-link">《Vue》笔记</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/wx-miniprogram/" class="nav-link">小程序笔记</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/javascriptbasics/" class="nav-link">JavaScript 基础</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/vdoingBlog/engineer/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>后端笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/pages/7fae73/" class="nav-link">Java</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/pages/fa6492/" class="nav-link">Spring</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/pages/37120b/" class="nav-link">算法</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/pages/53649b/" class="nav-link">高可用</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/pages/7d465c/" class="nav-link">高并发</a></li></ul></li><li class="dropdown-item"><h4>工作问题</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/pages/79637f/" class="nav-link">问题记录</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/vdoingBlog/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/9a7ee40fc232253e/" class="nav-link">各类工具使用</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试" class="dropdown-title"><a href="/vdoingBlog/interview/" class="link-title">面试</a> <span class="title" style="display:none;">面试</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>面试题库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/pages/a134b2/" class="nav-link">零碎</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/mianshi/" class="nav-link">面试常见题目汇总</a></li></ul></li><li class="dropdown-item"><h4>面试心得</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/pages/aea6571b7a8bae86/" class="nav-link">面试集锦</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/pages/331dbf/" class="nav-link">杂言碎语</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="读书派" class="dropdown-title"><a href="/vdoingBlog/bookssent/" class="link-title">读书派</a> <span class="title" style="display:none;">读书派</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>摘抄收录</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/ChickenSoup/" class="nav-link">☆ 励志鸡汤</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/PassionLife/" class="nav-link">❀ 人间烟火</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/ThingsLost/" class="nav-link">☣ 万物沦丧</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/NoTrouble/" class="nav-link">✌ 关掉烦恼</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/Bistro/" class="nav-link">✲ 小酒馆</a></li></ul></li><li class="dropdown-item"><h4>读书笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/note/xgqq/" class="nav-link">《小狗钱钱》</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/qbbfbb/" class="nav-link">《穷爸爸富爸爸》</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/cmrsyfgbjb/" class="nav-link">《聪明人使用方格笔记本》</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/vdoingBlog/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/vdoingBlog/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="收藏" class="dropdown-title"><a href="/vdoingBlog/pages/beb6c0bd8a66cea6/" class="link-title">收藏</a> <span class="title" style="display:none;">收藏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/beb6c0bd8a66cea6/" class="nav-link">网站</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/eee83a9211a70f9d/" class="nav-link">资源</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/12df8ace52d493f6/" class="nav-link">Vue资源</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/vdoingBlog/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vdoingBlog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/pasregret/vdoingBlog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/vdoingBlog/img/tx.jpg"> <div class="blogger-info"><h3>時念</h3> <span>
        一个有梦想的后端小菜鸡(✪ω✪)
      </span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/vdoingBlog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/vdoingBlog/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/pages/802a1ca6f7b71c59/" class="nav-link">Vue</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/note/javascript/" class="nav-link">《JavaScript教程》笔记</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/es6/" class="nav-link">《ES6 教程》笔记</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/vue/" class="nav-link">《Vue》笔记</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/wx-miniprogram/" class="nav-link">小程序笔记</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/javascriptbasics/" class="nav-link">JavaScript 基础</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/vdoingBlog/engineer/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>后端笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/pages/7fae73/" class="nav-link">Java</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/pages/fa6492/" class="nav-link">Spring</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/pages/37120b/" class="nav-link">算法</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/pages/53649b/" class="nav-link">高可用</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/pages/7d465c/" class="nav-link">高并发</a></li></ul></li><li class="dropdown-item"><h4>工作问题</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/pages/79637f/" class="nav-link">问题记录</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/vdoingBlog/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/9a7ee40fc232253e/" class="nav-link">各类工具使用</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试" class="dropdown-title"><a href="/vdoingBlog/interview/" class="link-title">面试</a> <span class="title" style="display:none;">面试</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>面试题库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/pages/a134b2/" class="nav-link">零碎</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/mianshi/" class="nav-link">面试常见题目汇总</a></li></ul></li><li class="dropdown-item"><h4>面试心得</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/pages/aea6571b7a8bae86/" class="nav-link">面试集锦</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/pages/331dbf/" class="nav-link">杂言碎语</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="读书派" class="dropdown-title"><a href="/vdoingBlog/bookssent/" class="link-title">读书派</a> <span class="title" style="display:none;">读书派</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>摘抄收录</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/ChickenSoup/" class="nav-link">☆ 励志鸡汤</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/PassionLife/" class="nav-link">❀ 人间烟火</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/ThingsLost/" class="nav-link">☣ 万物沦丧</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/NoTrouble/" class="nav-link">✌ 关掉烦恼</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/Bistro/" class="nav-link">✲ 小酒馆</a></li></ul></li><li class="dropdown-item"><h4>读书笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/note/xgqq/" class="nav-link">《小狗钱钱》</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/qbbfbb/" class="nav-link">《穷爸爸富爸爸》</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/cmrsyfgbjb/" class="nav-link">《聪明人使用方格笔记本》</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/vdoingBlog/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/vdoingBlog/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="收藏" class="dropdown-title"><a href="/vdoingBlog/pages/beb6c0bd8a66cea6/" class="link-title">收藏</a> <span class="title" style="display:none;">收藏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/beb6c0bd8a66cea6/" class="nav-link">网站</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/eee83a9211a70f9d/" class="nav-link">资源</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/12df8ace52d493f6/" class="nav-link">Vue资源</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/vdoingBlog/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vdoingBlog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/pasregret/vdoingBlog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>java</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vdoingBlog/pages/7fae73/" class="sidebar-link">java测试</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>spring</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>问题记录</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>高可用</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"> <div class="theme-vdoing-wrapper"><div class="articleInfo-wrap" data-v-f6108aee><div class="articleInfo" data-v-f6108aee><ul class="breadcrumbs" data-v-f6108aee><li data-v-f6108aee><a href="/vdoingBlog/" title="首页" class="iconfont icon-home router-link-active" data-v-f6108aee></a></li> <li data-v-f6108aee><a href="/vdoingBlog/engineer" title="后端-目录页" data-v-f6108aee>后端</a></li> <!----></ul> <div class="info" data-v-f6108aee><div title="作者" class="author iconfont icon-touxiang" data-v-f6108aee><a href="https://github.com/pasregret" target="_blank" title="作者" class="beLink" data-v-f6108aee>時念</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-f6108aee><a href="javascript:;" data-v-f6108aee>2024-03-26</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">
          redis-cluster
        </h1> <div class="theme-vdoing-content content__default"><h2 id="面试题"><a href="#面试题" class="header-anchor">#</a> 面试题</h2> <p>Redis 集群模式的工作原理能说一下么？在集群模式下，Redis 的 key 是如何寻址的？分布式寻址都有哪些算法？了解一致性 hash 算法吗？</p> <h2 id="面试官心理分析"><a href="#面试官心理分析" class="header-anchor">#</a> 面试官心理分析</h2> <p>在前几年，Redis 如果要搞几个节点，每个节点存储一部分的数据，得<strong>借助一些中间件</strong>来实现，比如说有 <code>codis</code> ，或者 <code>twemproxy</code> ，都有。有一些 Redis 中间件，你读写 Redis 中间件，Redis 中间件负责将你的数据分布式存储在多台机器上的 Redis 实例中。</p> <p>这两年，Redis 不断在发展，Redis 也不断有新的版本，现在的 Redis 集群模式，可以做到在多台机器上，部署多个 Redis 实例，每个实例存储一部分的数据，同时每个 Redis 主实例可以挂 Redis 从实例，自动确保说，如果 Redis 主实例挂了，会自动切换到 Redis 从实例上来。</p> <p>现在 Redis 的新版本，大家都是用 Redis cluster 的，也就是 Redis 原生支持的 Redis 集群模式，那么面试官肯定会就 Redis cluster 对你来个几连炮。要是你没用过 Redis cluster，正常，以前很多人用 codis 之类的客户端来支持集群，但是起码你得研究一下 Redis cluster 吧。</p> <p>如果你的数据量很少，主要是承载高并发高性能的场景，比如你的缓存一般就几个 G，单机就足够了，可以使用 replication，一个 master 多个 slaves，要几个 slave 跟你要求的读吞吐量有关，然后自己搭建一个 sentinel 集群去保证 Redis 主从架构的高可用性。</p> <p>Redis cluster，主要是针对<strong>海量数据+高并发+高可用</strong>的场景。Redis cluster 支撑 N 个 Redis master node，每个 master node 都可以挂载多个 slave node。这样整个 Redis 就可以横向扩容了。如果你要支撑更大数据量的缓存，那就横向扩容更多的 master 节点，每个 master 节点就能存放更多的数据了。</p> <h2 id="面试题剖析"><a href="#面试题剖析" class="header-anchor">#</a> 面试题剖析</h2> <h3 id="redis-cluster-介绍"><a href="#redis-cluster-介绍" class="header-anchor">#</a> Redis cluster 介绍</h3> <ul><li>自动将数据进行分片，每个 master 上放一部分数据</li> <li>提供内置的高可用支持，部分 master 不可用时，还是可以继续工作的</li></ul> <p>在 Redis cluster 架构下，每个 Redis 要放开两个端口号，比如一个是 6379，另外一个就是 加 1w 的端口号，比如 16379。</p> <p>16379 端口号是用来进行节点间通信的，也就是 cluster bus 的东西，cluster bus 的通信，用来进行故障检测、配置更新、故障转移授权。cluster bus 用了另外一种二进制的协议， <code>gossip</code> 协议，用于节点间进行高效的数据交换，占用更少的网络带宽和处理时间。</p> <h3 id="节点间的内部通信机制"><a href="#节点间的内部通信机制" class="header-anchor">#</a> 节点间的内部通信机制</h3> <h4 id="基本通信原理"><a href="#基本通信原理" class="header-anchor">#</a> 基本通信原理</h4> <p>集群元数据的维护有两种方式：集中式、Gossip 协议。Redis cluster 节点间采用 gossip 协议进行通信。</p> <p><strong>集中式</strong>是将集群元数据（节点信息、故障等等）集中存储在某个节点上。集中式元数据集中存储的一个典型代表，就是大数据领域的 <code>storm</code> 。它是分布式的大数据实时计算引擎，是集中式的元数据存储的结构，底层基于 zookeeper（分布式协调的中间件）对所有元数据进行存储维护。</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfcAAAEACAQAAAAE6/cNAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfiDBkPJjpxN/iWAAAORklEQVR42u2d/XdV1Z2HGTuzulbXmvkL+mN/7lrZiXAxIeZiaJOmREMnCOMSpWCra2rtwvGNCjpUnYKMnUVb2ilrdKY6gw4zzQJmtNVaxIKFEUIbkULFikhpJGB4ScC8PvNDdo73LYD1muTePM/+4Z57Tu7Oyed7n7P32TeQadNEREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREZIpyReXSsD10BUq0dYXtlUunXWE+E5KP6ZSW7GFryZYqs235mEpmPqZTPlQuDcynnR5KlR7amU+gYon5jHc+plNihO2BdkqdvQTCS+Yz3vmYTqnp3hVK+No8yjkCoct8xjsf0yk13QmUA4GA+Yx3Pqaj7uqu7qaj7uqu7uqu7uqu7uqu7uqu7upuwdRd3dXdgpmPuqu7BTMfdVd3C2Y+pqPuFsx8TEfd1d18TEfd1V3dTUfd1V3d1V3d1V3d1V3d1V3d1d23s7qru7pbMHVXd3W3YOaj7upuwczHdNTdgpmP6ai7upuP6ai7uqu76ai7uqu7uqu7uqu7uqu7uqu7uqu7uqu7ulswdVd3dZ+UBXub6+hT9zLKx3TUfUw6COpeVvmYzpTRvYPAFubwOXbzFHXUsx2A3SxkOl/kFQA2MocUjyahjn6/PlZTRzX3cS72tZl0/Lry0H0q5GM6U0r3x+hlJfU8TC8PcS0Av+B1+ljLXOAdArvpZX/e9XkFi+mkm1t5MB5ZTg/nykz3cs/HdKaU7n8AdsXHVwkMAnCBA/yQwACdVLK5wHTsPSo5BMAOZsUjB8tsMj8V8jGdKaV7b0YZRh/XUc8y7ovPnuXztNKeU7ADydQsEOing0BPGepe7vmYzhTX/R0CbwKvJMXpZy31OQXrJPDHAn2Vv+7llY/pTHHd3yKwgzPcTqCP4+xjgGeo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" alt="zookeeper-centralized-storage"></p> <p>Redis 维护集群元数据采用另一个方式， <code>gossip</code> 协议，所有节点都持有一份元数据，不同的节点如果出现了元数据的变更，就不断将元数据发送给其它的节点，让其它节点也进行元数据的变更。</p> <p><img src="data:image/png;base64,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" alt="Redis-gossip"></p> <p><strong>集中式</strong>的<strong>好处</strong>在于，元数据的读取和更新，时效性非常好，一旦元数据出现了变更，就立即更新到集中式的存储中，其它节点读取的时候就可以感知到；<strong>不好</strong>在于，所有的元数据的更新压力全部集中在一个地方，可能会导致元数据的存储有压力。</p> <p>gossip 好处在于，元数据的更新比较分散，不是集中在一个地方，更新请求会陆陆续续打到所有节点上去更新，降低了压力；不好在于，元数据的更新有延时，可能导致集群中的一些操作会有一些滞后。</p> <ul><li><p>10000 端口：每个节点都有一个专门用于节点间通信的端口，就是自己提供服务的端口号+10000，比如 7001，那么用于节点间通信的就是 17001 端口。每个节点每隔一段时间都会往另外几个节点发送 <code>ping</code> 消息，同时其它几个节点接收到 <code>ping</code> 之后返回 <code>pong</code> 。</p></li> <li><p>交换的信息：信息包括故障信息，节点的增加和删除，hash slot 信息等等。</p></li></ul> <h4 id="gossip-协议"><a href="#gossip-协议" class="header-anchor">#</a> gossip 协议</h4> <p>gossip 协议包含多种消息，包含 <code>ping</code> , <code>pong</code> , <code>meet</code> , <code>fail</code> 等等。</p> <ul><li>meet：某个节点发送 meet 给新加入的节点，让新节点加入集群中，然后新节点就会开始与其它节点进行通信。</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Redis-trib.rb add-node
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其实内部就是发送了一个 gossip meet 消息给新加入的节点，通知那个节点去加入我们的集群。</p> <ul><li>ping：每个节点都会频繁给其它节点发送 ping，其中包含自己的状态还有自己维护的集群元数据，互相通过 ping 交换元数据。</li> <li>pong：返回 ping 和 meet，包含自己的状态和其它信息，也用于信息广播和更新。</li> <li>fail：某个节点判断另一个节点 fail 之后，就发送 fail 给其它节点，通知其它节点说，某个节点宕机啦。</li></ul> <h4 id="ping-消息深入"><a href="#ping-消息深入" class="header-anchor">#</a> ping 消息深入</h4> <p>ping 时要携带一些元数据，如果很频繁，可能会加重网络负担。</p> <p>每个节点每秒会执行 10 次 ping，每次会选择 5 个最久没有通信的其它节点。当然如果发现某个节点通信延时达到了 <code>cluster_node_timeout / 2</code> ，那么立即发送 ping，避免数据交换延时过长，落后的时间太长了。比如说，两个节点之间都 10 分钟没有交换数据了，那么整个集群处于严重的元数据不一致的情况，就会有问题。所以 <code>cluster_node_timeout</code> 可以调节，如果调得比较大，那么会降低 ping 的频率。</p> <p>每次 ping，会带上自己节点的信息，还有就是带上 1/10 其它节点的信息，发送出去，进行交换。至少包含 <code>3</code> 个其它节点的信息，最多包含 <code>总节点数减 2</code> 个其它节点的信息。</p> <h3 id="分布式寻址算法"><a href="#分布式寻址算法" class="header-anchor">#</a> 分布式寻址算法</h3> <ul><li>hash 算法（大量缓存重建）</li> <li>一致性 hash 算法（自动缓存迁移）+ 虚拟节点（自动负载均衡）</li> <li>Redis cluster 的 hash slot 算法</li></ul> <h4 id="hash-算法"><a href="#hash-算法" class="header-anchor">#</a> hash 算法</h4> <p>来了一个 key，首先计算 hash 值，然后对节点数取模。然后打在不同的 master 节点上。一旦某一个 master 节点宕机，所有请求过来，都会基于最新的剩余 master 节点数去取模，尝试去取数据。这会导致<strong>大部分的请求过来，全部无法拿到有效的缓存</strong>，导致大量的流量涌入数据库。</p> <p><img src="data:image/png;base64,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" alt="hash"></p> <h4 id="一致性-hash-算法"><a href="#一致性-hash-算法" class="header-anchor">#</a> 一致性 hash 算法</h4> <p>一致性 hash 算法将整个 hash 值空间组织成一个虚拟的圆环，整个空间按顺时针方向组织，下一步将各个 master 节点（使用服务器的 ip 或主机名）进行 hash。这样就能确定每个节点在其哈希环上的位置。</p> <p>来了一个 key，首先计算 hash 值，并确定此数据在环上的位置，从此位置沿环<strong>顺时针“行走”</strong>，遇到的第一个 master 节点就是 key 所在位置。</p> <p>在一致性哈希算法中，如果一个节点挂了，受影响的数据仅仅是此节点到环空间前一个节点（沿着逆时针方向行走遇到的第一个节点）之间的数据，其它不受影响。增加一个节点也同理。</p> <p>燃鹅，一致性哈希算法在节点太少时，容易因为节点分布不均匀而造成<strong>缓存热点</strong>的问题。为了解决这种热点问题，一致性 hash 算法引入了虚拟节点机制，即对每一个节点计算多个 hash，每个计算结果位置都放置一个虚拟节点。这样就实现了数据的均匀分布，负载均衡。</p> <p><img src="/vdoingBlog/assets/img/consistent-hashing-algorithm.d9016a42.png" alt="consistent-hashing-algorithm"></p> <h4 id="redis-cluster-的-hash-slot-算法"><a href="#redis-cluster-的-hash-slot-算法" class="header-anchor">#</a> Redis cluster 的 hash slot 算法</h4> <p>Redis cluster 有固定的 <code>16384</code> 个 hash slot，对每个 <code>key</code> 计算 <code>CRC16</code> 值，然后对 <code>16384</code> 取模，可以获取 key 对应的 hash slot。</p> <p>Redis cluster 中每个 master 都会持有部分 slot，比如有 3 个 master，那么可能每个 master 持有 5000 多个 hash slot。hash slot 让 node 的增加和移除很简单，增加一个 master，就将其他 master 的 hash slot 移动部分过去，减少一个 master，就将它的 hash slot 移动到其他 master 上去。移动 hash slot 的成本是非常低的。客户端的 api，可以对指定的数据，让他们走同一个 hash slot，通过 <code>hash tag</code> 来实现。</p> <p>任何一台机器宕机，另外两个节点，不影响的。因为 key 找的是 hash slot，不是机器。</p> <p><img src="data:image/png;base64,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" alt="hash-slot"></p> <h3 id="redis-cluster-的高可用与主备切换原理"><a href="#redis-cluster-的高可用与主备切换原理" class="header-anchor">#</a> Redis cluster 的高可用与主备切换原理</h3> <p>Redis cluster 的高可用的原理，几乎跟哨兵是类似的。</p> <h4 id="判断节点宕机"><a href="#判断节点宕机" class="header-anchor">#</a> 判断节点宕机</h4> <p>如果一个节点认为另外一个节点宕机，那么就是 <code>pfail</code> ，<strong>主观宕机</strong>。如果多个节点都认为另外一个节点宕机了，那么就是 <code>fail</code> ，<strong>客观宕机</strong>，跟哨兵的原理几乎一样，sdown，odown。</p> <p>在 <code>cluster-node-timeout</code> 内，某个节点一直没有返回 <code>pong</code> ，那么就被认为 <code>pfail</code> 。</p> <p>如果一个节点认为某个节点 <code>pfail</code> 了，那么会在 <code>gossip ping</code> 消息中， <code>ping</code> 给其他节点，如果<strong>超过半数</strong>的节点都认为 <code>pfail</code> 了，那么就会变成 <code>fail</code> 。</p> <h4 id="从节点过滤"><a href="#从节点过滤" class="header-anchor">#</a> 从节点过滤</h4> <p>对宕机的 master node，从其所有的 slave node 中，选择一个切换成 master node。</p> <p>检查每个 slave node 与 master node 断开连接的时间，如果超过了 <code>cluster-node-timeout * cluster-slave-validity-factor</code> ，那么就<strong>没有资格</strong>切换成 <code>master</code> 。</p> <h4 id="从节点选举"><a href="#从节点选举" class="header-anchor">#</a> 从节点选举</h4> <p>每个从节点，都根据自己对 master 复制数据的 offset，来设置一个选举时间，offset 越大（复制数据越多）的从节点，选举时间越靠前，优先进行选举。</p> <p>所有的 master node 开始 slave 选举投票，给要进行选举的 slave 进行投票，如果大部分 master node <code>（N/2 + 1）</code> 都投票给了某个从节点，那么选举通过，那个从节点可以切换成 master。</p> <p>从节点执行主备切换，从节点切换为主节点。</p> <h4 id="与哨兵比较"><a href="#与哨兵比较" class="header-anchor">#</a> 与哨兵比较</h4> <p>整个流程跟哨兵相比，非常类似，所以说，Redis cluster 功能强大，直接集成了 replication 和 sentinel 的功能。</p></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/pasregret/vdoingBlog/edit/master/docs/02.后端/high-concurrency/redis-cluster.md" target="_blank" rel="noopener noreferrer">编辑</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2024/03/26, 9:03:00</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <div class="article-list"><div class="article-title"><a href="/vdoingBlog/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/vdoingBlog/pages/bc52b9/"><div>database-shard-dynamic-expand</div></a> <span>03-26</span></dt></dl><dl><dd>02</dd> <dt><a href="/vdoingBlog/pages/7d465c/"><div>README</div></a> <span>03-26</span></dt></dl><dl><dd>03</dd> <dt><a href="/vdoingBlog/pages/b3459f/"><div>database-shard-global-id-generate</div></a> <span>03-26</span></dt></dl> <dl><dd></dd> <dt><a href="/vdoingBlog/archives/" class="more">更多文章&gt;</a></dt></dl></div></div> </main></div> <div class="footer"><div class="icons"><a href="https://msg.cnblogs.com/send/pasregret" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://blog.csdn.net/qq_17589751?type=blog" title="CSDN" target="_blank" class="iconfont icon-csdn"></a><a href="https://github.com/pasregret" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=2507037283" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
     | Copyright © 2019-2024
    <span>時念 | <a href="https://github.com/pasregret/vdoingBlog/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/vdoingBlog/assets/js/app.b9445f3d.js" defer></script><script src="/vdoingBlog/assets/js/2.6f6622d0.js" defer></script><script src="/vdoingBlog/assets/js/3.2637abc7.js" defer></script><script src="/vdoingBlog/assets/js/5.5bfcaf23.js" defer></script>
  </body>
</html>