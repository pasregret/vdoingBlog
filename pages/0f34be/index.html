<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>redis-master-slave | 時念</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/vdoingBlog/img/csdn.ico">
    <link rel="stylesheet" href="/vdoingBlog/icon/iconfont.css">
    <meta name="description" content="在努力一点，成为更优秀的人">
    <meta name="keywords" content="全栈博客,个人技术博客,前端,后端开发,后端框架,技术文档,学习,面试,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/vdoingBlog/assets/css/0.styles.1a8a0045.css" as="style"><link rel="preload" href="/vdoingBlog/assets/js/app.b9445f3d.js" as="script"><link rel="preload" href="/vdoingBlog/assets/js/2.6f6622d0.js" as="script"><link rel="preload" href="/vdoingBlog/assets/js/3.2637abc7.js" as="script"><link rel="preload" href="/vdoingBlog/assets/js/10.f47bb344.js" as="script"><link rel="prefetch" href="/vdoingBlog/assets/js/100.42845136.js"><link rel="prefetch" href="/vdoingBlog/assets/js/101.f4fa1fb3.js"><link rel="prefetch" href="/vdoingBlog/assets/js/102.3b223ea5.js"><link rel="prefetch" href="/vdoingBlog/assets/js/103.2feef0d7.js"><link rel="prefetch" href="/vdoingBlog/assets/js/104.d8c00bff.js"><link rel="prefetch" href="/vdoingBlog/assets/js/105.20cd0607.js"><link rel="prefetch" href="/vdoingBlog/assets/js/106.001d93be.js"><link rel="prefetch" href="/vdoingBlog/assets/js/107.b8d7babc.js"><link rel="prefetch" href="/vdoingBlog/assets/js/108.910bf8f7.js"><link rel="prefetch" href="/vdoingBlog/assets/js/109.78853843.js"><link rel="prefetch" href="/vdoingBlog/assets/js/11.aa074a37.js"><link rel="prefetch" href="/vdoingBlog/assets/js/110.d242bfec.js"><link rel="prefetch" href="/vdoingBlog/assets/js/111.6a5c9de7.js"><link rel="prefetch" href="/vdoingBlog/assets/js/112.d252eeeb.js"><link rel="prefetch" href="/vdoingBlog/assets/js/113.d9f0ce34.js"><link rel="prefetch" href="/vdoingBlog/assets/js/114.fe4b6af6.js"><link rel="prefetch" href="/vdoingBlog/assets/js/115.e4a474d2.js"><link rel="prefetch" href="/vdoingBlog/assets/js/116.aeca2095.js"><link rel="prefetch" href="/vdoingBlog/assets/js/117.d7dc004d.js"><link rel="prefetch" href="/vdoingBlog/assets/js/118.84bcb9d9.js"><link rel="prefetch" href="/vdoingBlog/assets/js/119.4dfa1c83.js"><link rel="prefetch" href="/vdoingBlog/assets/js/12.5d63e14e.js"><link rel="prefetch" href="/vdoingBlog/assets/js/120.854e657f.js"><link rel="prefetch" href="/vdoingBlog/assets/js/121.6da2d006.js"><link rel="prefetch" href="/vdoingBlog/assets/js/122.c3b31eb5.js"><link rel="prefetch" href="/vdoingBlog/assets/js/123.11d5eecd.js"><link rel="prefetch" href="/vdoingBlog/assets/js/124.7a3b425f.js"><link rel="prefetch" href="/vdoingBlog/assets/js/125.b9e5125a.js"><link rel="prefetch" href="/vdoingBlog/assets/js/126.5c6a319c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/127.c4f91b82.js"><link rel="prefetch" href="/vdoingBlog/assets/js/128.a44c3fa4.js"><link rel="prefetch" href="/vdoingBlog/assets/js/129.f8682a40.js"><link rel="prefetch" href="/vdoingBlog/assets/js/13.a5ee467c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/130.8c1775aa.js"><link rel="prefetch" href="/vdoingBlog/assets/js/131.55c54bc6.js"><link rel="prefetch" href="/vdoingBlog/assets/js/132.7d15b20e.js"><link rel="prefetch" href="/vdoingBlog/assets/js/133.b29cf3ba.js"><link rel="prefetch" href="/vdoingBlog/assets/js/134.314ca301.js"><link rel="prefetch" href="/vdoingBlog/assets/js/135.360ddced.js"><link rel="prefetch" href="/vdoingBlog/assets/js/136.78a4c5a1.js"><link rel="prefetch" href="/vdoingBlog/assets/js/137.940596c3.js"><link rel="prefetch" href="/vdoingBlog/assets/js/138.2ec64349.js"><link rel="prefetch" href="/vdoingBlog/assets/js/139.5a9b5fe5.js"><link rel="prefetch" href="/vdoingBlog/assets/js/14.512fbd60.js"><link rel="prefetch" href="/vdoingBlog/assets/js/140.508c1e62.js"><link rel="prefetch" href="/vdoingBlog/assets/js/141.1cf87c66.js"><link rel="prefetch" href="/vdoingBlog/assets/js/142.d0673700.js"><link rel="prefetch" href="/vdoingBlog/assets/js/143.d931e217.js"><link rel="prefetch" href="/vdoingBlog/assets/js/144.2ba080d0.js"><link rel="prefetch" href="/vdoingBlog/assets/js/145.34a66124.js"><link rel="prefetch" href="/vdoingBlog/assets/js/146.7326184c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/147.9a40c0bc.js"><link rel="prefetch" href="/vdoingBlog/assets/js/148.5a0704ca.js"><link rel="prefetch" href="/vdoingBlog/assets/js/149.50811395.js"><link rel="prefetch" href="/vdoingBlog/assets/js/15.0e6b28e8.js"><link rel="prefetch" href="/vdoingBlog/assets/js/150.ce4936ee.js"><link rel="prefetch" href="/vdoingBlog/assets/js/151.d3b6c741.js"><link rel="prefetch" href="/vdoingBlog/assets/js/152.cf8a427e.js"><link rel="prefetch" href="/vdoingBlog/assets/js/153.67b4278d.js"><link rel="prefetch" href="/vdoingBlog/assets/js/154.696fd65b.js"><link rel="prefetch" href="/vdoingBlog/assets/js/155.fb50bb35.js"><link rel="prefetch" href="/vdoingBlog/assets/js/156.1cfd70cc.js"><link rel="prefetch" href="/vdoingBlog/assets/js/157.2686ced9.js"><link rel="prefetch" href="/vdoingBlog/assets/js/158.2ae25174.js"><link rel="prefetch" href="/vdoingBlog/assets/js/159.7f50d687.js"><link rel="prefetch" href="/vdoingBlog/assets/js/16.d111875a.js"><link rel="prefetch" href="/vdoingBlog/assets/js/160.f6a1a2f6.js"><link rel="prefetch" href="/vdoingBlog/assets/js/161.4de2d7b6.js"><link rel="prefetch" href="/vdoingBlog/assets/js/162.e07ff9e5.js"><link rel="prefetch" href="/vdoingBlog/assets/js/163.b6d85d31.js"><link rel="prefetch" href="/vdoingBlog/assets/js/164.9df7b62a.js"><link rel="prefetch" href="/vdoingBlog/assets/js/165.15094616.js"><link rel="prefetch" href="/vdoingBlog/assets/js/166.4502e212.js"><link rel="prefetch" href="/vdoingBlog/assets/js/167.0082e3a6.js"><link rel="prefetch" href="/vdoingBlog/assets/js/168.a1f1e027.js"><link rel="prefetch" href="/vdoingBlog/assets/js/169.7182c79d.js"><link rel="prefetch" href="/vdoingBlog/assets/js/17.a6b9fe89.js"><link rel="prefetch" href="/vdoingBlog/assets/js/170.419f80a9.js"><link rel="prefetch" href="/vdoingBlog/assets/js/171.067de789.js"><link rel="prefetch" href="/vdoingBlog/assets/js/172.ebcd5f51.js"><link rel="prefetch" href="/vdoingBlog/assets/js/173.6ea25a9e.js"><link rel="prefetch" href="/vdoingBlog/assets/js/174.048ac45b.js"><link rel="prefetch" href="/vdoingBlog/assets/js/175.21ad8213.js"><link rel="prefetch" href="/vdoingBlog/assets/js/176.fc821e09.js"><link rel="prefetch" href="/vdoingBlog/assets/js/177.288a7737.js"><link rel="prefetch" href="/vdoingBlog/assets/js/178.0f0a8e39.js"><link rel="prefetch" href="/vdoingBlog/assets/js/179.5e6de083.js"><link rel="prefetch" href="/vdoingBlog/assets/js/18.6be9a6f0.js"><link rel="prefetch" href="/vdoingBlog/assets/js/180.a2bb75b2.js"><link rel="prefetch" href="/vdoingBlog/assets/js/181.cc9aad01.js"><link rel="prefetch" href="/vdoingBlog/assets/js/182.3be491c0.js"><link rel="prefetch" href="/vdoingBlog/assets/js/183.ff692088.js"><link rel="prefetch" href="/vdoingBlog/assets/js/184.ab527a41.js"><link rel="prefetch" href="/vdoingBlog/assets/js/185.27c47df6.js"><link rel="prefetch" href="/vdoingBlog/assets/js/186.e79580bc.js"><link rel="prefetch" href="/vdoingBlog/assets/js/187.216360af.js"><link rel="prefetch" href="/vdoingBlog/assets/js/188.24cadeb0.js"><link rel="prefetch" href="/vdoingBlog/assets/js/189.da233a87.js"><link rel="prefetch" href="/vdoingBlog/assets/js/19.86f6452b.js"><link rel="prefetch" href="/vdoingBlog/assets/js/190.7f5da3da.js"><link rel="prefetch" href="/vdoingBlog/assets/js/191.8c4fce80.js"><link rel="prefetch" href="/vdoingBlog/assets/js/192.de037120.js"><link rel="prefetch" href="/vdoingBlog/assets/js/193.49af491f.js"><link rel="prefetch" href="/vdoingBlog/assets/js/194.33cd7c3d.js"><link rel="prefetch" href="/vdoingBlog/assets/js/195.d50e2b4a.js"><link rel="prefetch" href="/vdoingBlog/assets/js/196.f4ac2d96.js"><link rel="prefetch" href="/vdoingBlog/assets/js/197.e83bd5da.js"><link rel="prefetch" href="/vdoingBlog/assets/js/198.b746f9b4.js"><link rel="prefetch" href="/vdoingBlog/assets/js/199.287a6928.js"><link rel="prefetch" href="/vdoingBlog/assets/js/20.7ca85149.js"><link rel="prefetch" href="/vdoingBlog/assets/js/200.af57083b.js"><link rel="prefetch" href="/vdoingBlog/assets/js/201.de53962d.js"><link rel="prefetch" href="/vdoingBlog/assets/js/202.e39e4c9e.js"><link rel="prefetch" href="/vdoingBlog/assets/js/203.8a43da34.js"><link rel="prefetch" href="/vdoingBlog/assets/js/204.3b48e56b.js"><link rel="prefetch" href="/vdoingBlog/assets/js/205.58152076.js"><link rel="prefetch" href="/vdoingBlog/assets/js/206.7a570980.js"><link rel="prefetch" href="/vdoingBlog/assets/js/207.522085c9.js"><link rel="prefetch" href="/vdoingBlog/assets/js/208.c169e955.js"><link rel="prefetch" href="/vdoingBlog/assets/js/209.243ad8a0.js"><link rel="prefetch" href="/vdoingBlog/assets/js/21.bba7fcbf.js"><link rel="prefetch" href="/vdoingBlog/assets/js/210.c3553b91.js"><link rel="prefetch" href="/vdoingBlog/assets/js/211.e8a75c3c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/212.199703db.js"><link rel="prefetch" href="/vdoingBlog/assets/js/213.2dea942d.js"><link rel="prefetch" href="/vdoingBlog/assets/js/214.40c70c39.js"><link rel="prefetch" href="/vdoingBlog/assets/js/215.6ddaa777.js"><link rel="prefetch" href="/vdoingBlog/assets/js/216.b8389550.js"><link rel="prefetch" href="/vdoingBlog/assets/js/217.034a8d97.js"><link rel="prefetch" href="/vdoingBlog/assets/js/218.326799dd.js"><link rel="prefetch" href="/vdoingBlog/assets/js/219.1ce05f0c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/22.6a217f79.js"><link rel="prefetch" href="/vdoingBlog/assets/js/220.f4b2b31f.js"><link rel="prefetch" href="/vdoingBlog/assets/js/221.6f4b7e7d.js"><link rel="prefetch" href="/vdoingBlog/assets/js/222.ddfc21ad.js"><link rel="prefetch" href="/vdoingBlog/assets/js/223.3285a573.js"><link rel="prefetch" href="/vdoingBlog/assets/js/224.1887e1cf.js"><link rel="prefetch" href="/vdoingBlog/assets/js/225.d665d7de.js"><link rel="prefetch" href="/vdoingBlog/assets/js/226.d8d88acb.js"><link rel="prefetch" href="/vdoingBlog/assets/js/227.dedbc9b5.js"><link rel="prefetch" href="/vdoingBlog/assets/js/228.9f28147a.js"><link rel="prefetch" href="/vdoingBlog/assets/js/229.5d3f5869.js"><link rel="prefetch" href="/vdoingBlog/assets/js/23.6f37664f.js"><link rel="prefetch" href="/vdoingBlog/assets/js/230.b31887a1.js"><link rel="prefetch" href="/vdoingBlog/assets/js/231.67fec01a.js"><link rel="prefetch" href="/vdoingBlog/assets/js/232.bea7df27.js"><link rel="prefetch" href="/vdoingBlog/assets/js/233.5b3c6857.js"><link rel="prefetch" href="/vdoingBlog/assets/js/234.55f4734c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/235.64aa2ea9.js"><link rel="prefetch" href="/vdoingBlog/assets/js/236.a2b44de4.js"><link rel="prefetch" href="/vdoingBlog/assets/js/237.ce4d1dda.js"><link rel="prefetch" href="/vdoingBlog/assets/js/238.00c4438d.js"><link rel="prefetch" href="/vdoingBlog/assets/js/239.3a6c497a.js"><link rel="prefetch" href="/vdoingBlog/assets/js/24.330545a3.js"><link rel="prefetch" href="/vdoingBlog/assets/js/240.3289617c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/241.44123b24.js"><link rel="prefetch" href="/vdoingBlog/assets/js/242.f6843956.js"><link rel="prefetch" href="/vdoingBlog/assets/js/243.0eb3259e.js"><link rel="prefetch" href="/vdoingBlog/assets/js/244.b456176f.js"><link rel="prefetch" href="/vdoingBlog/assets/js/245.464aa68a.js"><link rel="prefetch" href="/vdoingBlog/assets/js/246.b2fd97f3.js"><link rel="prefetch" href="/vdoingBlog/assets/js/247.01768412.js"><link rel="prefetch" href="/vdoingBlog/assets/js/248.cb33fa7d.js"><link rel="prefetch" href="/vdoingBlog/assets/js/249.d0a22772.js"><link rel="prefetch" href="/vdoingBlog/assets/js/25.2affc905.js"><link rel="prefetch" href="/vdoingBlog/assets/js/250.bbb1d9f8.js"><link rel="prefetch" href="/vdoingBlog/assets/js/251.17732198.js"><link rel="prefetch" href="/vdoingBlog/assets/js/252.67ead1f3.js"><link rel="prefetch" href="/vdoingBlog/assets/js/253.ff7432e4.js"><link rel="prefetch" href="/vdoingBlog/assets/js/254.58f13ff0.js"><link rel="prefetch" href="/vdoingBlog/assets/js/255.96282a6c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/256.16c6996c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/257.11426b0d.js"><link rel="prefetch" href="/vdoingBlog/assets/js/258.fc70ecd1.js"><link rel="prefetch" href="/vdoingBlog/assets/js/259.64662286.js"><link rel="prefetch" href="/vdoingBlog/assets/js/26.7460efa9.js"><link rel="prefetch" href="/vdoingBlog/assets/js/260.be886c6b.js"><link rel="prefetch" href="/vdoingBlog/assets/js/261.25f1bb31.js"><link rel="prefetch" href="/vdoingBlog/assets/js/262.793852d7.js"><link rel="prefetch" href="/vdoingBlog/assets/js/263.4963bbd6.js"><link rel="prefetch" href="/vdoingBlog/assets/js/264.e91dc44c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/265.2e93a9c1.js"><link rel="prefetch" href="/vdoingBlog/assets/js/266.d5ed2010.js"><link rel="prefetch" href="/vdoingBlog/assets/js/267.002129a4.js"><link rel="prefetch" href="/vdoingBlog/assets/js/268.09446f1b.js"><link rel="prefetch" href="/vdoingBlog/assets/js/269.23bf3d9b.js"><link rel="prefetch" href="/vdoingBlog/assets/js/27.8cf99488.js"><link rel="prefetch" href="/vdoingBlog/assets/js/270.dd152eff.js"><link rel="prefetch" href="/vdoingBlog/assets/js/271.38eeda08.js"><link rel="prefetch" href="/vdoingBlog/assets/js/272.41de06d9.js"><link rel="prefetch" href="/vdoingBlog/assets/js/273.b8af50b4.js"><link rel="prefetch" href="/vdoingBlog/assets/js/274.724e5983.js"><link rel="prefetch" href="/vdoingBlog/assets/js/275.713c772c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/276.c7c193c3.js"><link rel="prefetch" href="/vdoingBlog/assets/js/277.893f4cf7.js"><link rel="prefetch" href="/vdoingBlog/assets/js/278.358b4464.js"><link rel="prefetch" href="/vdoingBlog/assets/js/279.41cb7fc2.js"><link rel="prefetch" href="/vdoingBlog/assets/js/28.5e432976.js"><link rel="prefetch" href="/vdoingBlog/assets/js/280.db41c095.js"><link rel="prefetch" href="/vdoingBlog/assets/js/281.bb0b84a9.js"><link rel="prefetch" href="/vdoingBlog/assets/js/282.54b9417c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/29.f7b9a0a6.js"><link rel="prefetch" href="/vdoingBlog/assets/js/30.fce3b883.js"><link rel="prefetch" href="/vdoingBlog/assets/js/31.e0777ef5.js"><link rel="prefetch" href="/vdoingBlog/assets/js/32.025aa98c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/33.d34cfc3c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/34.223f1e50.js"><link rel="prefetch" href="/vdoingBlog/assets/js/35.3d291932.js"><link rel="prefetch" href="/vdoingBlog/assets/js/36.74b28a40.js"><link rel="prefetch" href="/vdoingBlog/assets/js/37.f0702c91.js"><link rel="prefetch" href="/vdoingBlog/assets/js/38.15da7dbf.js"><link rel="prefetch" href="/vdoingBlog/assets/js/39.932b8cb6.js"><link rel="prefetch" href="/vdoingBlog/assets/js/4.a491a05d.js"><link rel="prefetch" href="/vdoingBlog/assets/js/40.e249bf9a.js"><link rel="prefetch" href="/vdoingBlog/assets/js/41.690459ca.js"><link rel="prefetch" href="/vdoingBlog/assets/js/42.5bd5f7f0.js"><link rel="prefetch" href="/vdoingBlog/assets/js/43.f7e5a4b6.js"><link rel="prefetch" href="/vdoingBlog/assets/js/44.5a483a79.js"><link rel="prefetch" href="/vdoingBlog/assets/js/45.c0bc03f5.js"><link rel="prefetch" href="/vdoingBlog/assets/js/46.a5974c35.js"><link rel="prefetch" href="/vdoingBlog/assets/js/47.747acaf5.js"><link rel="prefetch" href="/vdoingBlog/assets/js/48.58258c94.js"><link rel="prefetch" href="/vdoingBlog/assets/js/49.973c09f1.js"><link rel="prefetch" href="/vdoingBlog/assets/js/5.5bfcaf23.js"><link rel="prefetch" href="/vdoingBlog/assets/js/50.8cf73048.js"><link rel="prefetch" href="/vdoingBlog/assets/js/51.b21c4ce2.js"><link rel="prefetch" href="/vdoingBlog/assets/js/52.93254a3c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/53.62ca680c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/54.b69108ab.js"><link rel="prefetch" href="/vdoingBlog/assets/js/55.91dc99a4.js"><link rel="prefetch" href="/vdoingBlog/assets/js/56.4c7a79d1.js"><link rel="prefetch" href="/vdoingBlog/assets/js/57.83aef27e.js"><link rel="prefetch" href="/vdoingBlog/assets/js/58.54926fb5.js"><link rel="prefetch" href="/vdoingBlog/assets/js/59.c69b7d5a.js"><link rel="prefetch" href="/vdoingBlog/assets/js/6.a1476036.js"><link rel="prefetch" href="/vdoingBlog/assets/js/60.34ba73de.js"><link rel="prefetch" href="/vdoingBlog/assets/js/61.dfad92b5.js"><link rel="prefetch" href="/vdoingBlog/assets/js/62.969e8a20.js"><link rel="prefetch" href="/vdoingBlog/assets/js/63.b8e0f8a2.js"><link rel="prefetch" href="/vdoingBlog/assets/js/64.d8b8bd5e.js"><link rel="prefetch" href="/vdoingBlog/assets/js/65.e5de6837.js"><link rel="prefetch" href="/vdoingBlog/assets/js/66.a26401e1.js"><link rel="prefetch" href="/vdoingBlog/assets/js/67.00210a72.js"><link rel="prefetch" href="/vdoingBlog/assets/js/68.e910883f.js"><link rel="prefetch" href="/vdoingBlog/assets/js/69.4ee7f4d3.js"><link rel="prefetch" href="/vdoingBlog/assets/js/7.97c75439.js"><link rel="prefetch" href="/vdoingBlog/assets/js/70.a460a602.js"><link rel="prefetch" href="/vdoingBlog/assets/js/71.5c33e129.js"><link rel="prefetch" href="/vdoingBlog/assets/js/72.a71d8d18.js"><link rel="prefetch" href="/vdoingBlog/assets/js/73.5742fae2.js"><link rel="prefetch" href="/vdoingBlog/assets/js/74.51cb4883.js"><link rel="prefetch" href="/vdoingBlog/assets/js/75.e88f1ce2.js"><link rel="prefetch" href="/vdoingBlog/assets/js/76.0ba0af41.js"><link rel="prefetch" href="/vdoingBlog/assets/js/77.64546166.js"><link rel="prefetch" href="/vdoingBlog/assets/js/78.6ba65b66.js"><link rel="prefetch" href="/vdoingBlog/assets/js/79.14e24020.js"><link rel="prefetch" href="/vdoingBlog/assets/js/8.a941c0a5.js"><link rel="prefetch" href="/vdoingBlog/assets/js/80.b9cd74eb.js"><link rel="prefetch" href="/vdoingBlog/assets/js/81.f49a364d.js"><link rel="prefetch" href="/vdoingBlog/assets/js/82.7d338240.js"><link rel="prefetch" href="/vdoingBlog/assets/js/83.fcbcdac1.js"><link rel="prefetch" href="/vdoingBlog/assets/js/84.1003ec25.js"><link rel="prefetch" href="/vdoingBlog/assets/js/85.0b8c5902.js"><link rel="prefetch" href="/vdoingBlog/assets/js/86.4e9c3774.js"><link rel="prefetch" href="/vdoingBlog/assets/js/87.8be27033.js"><link rel="prefetch" href="/vdoingBlog/assets/js/88.cdf074e7.js"><link rel="prefetch" href="/vdoingBlog/assets/js/89.8d3f92c1.js"><link rel="prefetch" href="/vdoingBlog/assets/js/9.249dec4c.js"><link rel="prefetch" href="/vdoingBlog/assets/js/90.089c63ac.js"><link rel="prefetch" href="/vdoingBlog/assets/js/91.397865aa.js"><link rel="prefetch" href="/vdoingBlog/assets/js/92.240472ae.js"><link rel="prefetch" href="/vdoingBlog/assets/js/93.2e5c2e33.js"><link rel="prefetch" href="/vdoingBlog/assets/js/94.788d4e86.js"><link rel="prefetch" href="/vdoingBlog/assets/js/95.d69ebc8e.js"><link rel="prefetch" href="/vdoingBlog/assets/js/96.ccf3cb00.js"><link rel="prefetch" href="/vdoingBlog/assets/js/97.a44a6468.js"><link rel="prefetch" href="/vdoingBlog/assets/js/98.f286d274.js"><link rel="prefetch" href="/vdoingBlog/assets/js/99.e3822a1d.js">
    <link rel="stylesheet" href="/vdoingBlog/assets/css/0.styles.1a8a0045.css">
    <style>
      .theme-mode-light:after{background-image: url(https://img.xjh.me/random_img.php?ctype=acg&return=302&type=bg);content: "";background-repeat: no-repeat;background-position: 50%;opacity: .06;-moz-filter: grayscale(100%);-ms-filter: grayscale(100%);-o-filter: grayscale(100%);filter: grayscale(100%);filter: #808080;position: fixed;top: 0;left: 0;width: 100%;height: 100%;z-index: -1;}
      .theme-vdoing-wrapper{letter-spacing: 2px!important;background-image: linear-gradient(90deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%), linear-gradient(360deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%)!important;background-size: 20px 20px!important;background-position: center center!important}
</style>
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vdoingBlog/" class="home-link router-link-active"><img src="/vdoingBlog/img/csdn.png" alt="時念" class="logo"> <span class="site-name can-hide"></span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vdoingBlog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/vdoingBlog/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/pages/802a1ca6f7b71c59/" class="nav-link">Vue</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/note/javascript/" class="nav-link">《JavaScript教程》笔记</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/es6/" class="nav-link">《ES6 教程》笔记</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/vue/" class="nav-link">《Vue》笔记</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/wx-miniprogram/" class="nav-link">小程序笔记</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/javascriptbasics/" class="nav-link">JavaScript 基础</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/vdoingBlog/engineer/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>后端笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/pages/7fae73/" class="nav-link">Java</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/pages/fa6492/" class="nav-link">Spring</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/pages/37120b/" class="nav-link">算法</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/pages/53649b/" class="nav-link">高可用</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/pages/7d465c/" class="nav-link">高并发</a></li></ul></li><li class="dropdown-item"><h4>工作问题</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/pages/79637f/" class="nav-link">问题记录</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/vdoingBlog/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/9a7ee40fc232253e/" class="nav-link">各类工具使用</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试" class="dropdown-title"><a href="/vdoingBlog/interview/" class="link-title">面试</a> <span class="title" style="display:none;">面试</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>面试题库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/pages/a134b2/" class="nav-link">零碎</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/mianshi/" class="nav-link">面试常见题目汇总</a></li></ul></li><li class="dropdown-item"><h4>面试心得</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/pages/aea6571b7a8bae86/" class="nav-link">面试集锦</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/pages/331dbf/" class="nav-link">杂言碎语</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="读书派" class="dropdown-title"><a href="/vdoingBlog/bookssent/" class="link-title">读书派</a> <span class="title" style="display:none;">读书派</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>摘抄收录</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/ChickenSoup/" class="nav-link">☆ 励志鸡汤</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/PassionLife/" class="nav-link">❀ 人间烟火</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/ThingsLost/" class="nav-link">☣ 万物沦丧</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/NoTrouble/" class="nav-link">✌ 关掉烦恼</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/Bistro/" class="nav-link">✲ 小酒馆</a></li></ul></li><li class="dropdown-item"><h4>读书笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/note/xgqq/" class="nav-link">《小狗钱钱》</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/qbbfbb/" class="nav-link">《穷爸爸富爸爸》</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/cmrsyfgbjb/" class="nav-link">《聪明人使用方格笔记本》</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/vdoingBlog/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/vdoingBlog/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="收藏" class="dropdown-title"><a href="/vdoingBlog/pages/beb6c0bd8a66cea6/" class="link-title">收藏</a> <span class="title" style="display:none;">收藏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/beb6c0bd8a66cea6/" class="nav-link">网站</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/eee83a9211a70f9d/" class="nav-link">资源</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/12df8ace52d493f6/" class="nav-link">Vue资源</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/vdoingBlog/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vdoingBlog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/pasregret/vdoingBlog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/vdoingBlog/img/tx.jpg"> <div class="blogger-info"><h3>時念</h3> <span>
        一个有梦想的后端小菜鸡(✪ω✪)
      </span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/vdoingBlog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/vdoingBlog/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/pages/8143cc480faf9a11/" class="nav-link">JavaScript</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/pages/802a1ca6f7b71c59/" class="nav-link">Vue</a></li></ul></li><li class="dropdown-item"><h4>学习笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/note/javascript/" class="nav-link">《JavaScript教程》笔记</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/es6/" class="nav-link">《ES6 教程》笔记</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/vue/" class="nav-link">《Vue》笔记</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/typescript-axios/" class="nav-link">《TypeScript 从零实现 axios》</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/wx-miniprogram/" class="nav-link">小程序笔记</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/javascriptbasics/" class="nav-link">JavaScript 基础</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/vdoingBlog/engineer/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>后端笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/pages/7fae73/" class="nav-link">Java</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/pages/fa6492/" class="nav-link">Spring</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/pages/37120b/" class="nav-link">算法</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/pages/53649b/" class="nav-link">高可用</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/pages/7d465c/" class="nav-link">高并发</a></li></ul></li><li class="dropdown-item"><h4>工作问题</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/pages/79637f/" class="nav-link">问题记录</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/vdoingBlog/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/9a7ee40fc232253e/" class="nav-link">各类工具使用</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/4c778760be26d8b3/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试" class="dropdown-title"><a href="/vdoingBlog/interview/" class="link-title">面试</a> <span class="title" style="display:none;">面试</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>面试题库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/pages/a134b2/" class="nav-link">零碎</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/mianshi/" class="nav-link">面试常见题目汇总</a></li></ul></li><li class="dropdown-item"><h4>面试心得</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/pages/aea6571b7a8bae86/" class="nav-link">面试集锦</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/pages/331dbf/" class="nav-link">杂言碎语</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="读书派" class="dropdown-title"><a href="/vdoingBlog/bookssent/" class="link-title">读书派</a> <span class="title" style="display:none;">读书派</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>摘抄收录</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/ChickenSoup/" class="nav-link">☆ 励志鸡汤</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/PassionLife/" class="nav-link">❀ 人间烟火</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/ThingsLost/" class="nav-link">☣ 万物沦丧</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/NoTrouble/" class="nav-link">✌ 关掉烦恼</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/Bistro/" class="nav-link">✲ 小酒馆</a></li></ul></li><li class="dropdown-item"><h4>读书笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vdoingBlog/note/xgqq/" class="nav-link">《小狗钱钱》</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/qbbfbb/" class="nav-link">《穷爸爸富爸爸》</a></li><li class="dropdown-subitem"><a href="/vdoingBlog/note/cmrsyfgbjb/" class="nav-link">《聪明人使用方格笔记本》</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/vdoingBlog/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/vdoingBlog/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="收藏" class="dropdown-title"><a href="/vdoingBlog/pages/beb6c0bd8a66cea6/" class="link-title">收藏</a> <span class="title" style="display:none;">收藏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/beb6c0bd8a66cea6/" class="nav-link">网站</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/eee83a9211a70f9d/" class="nav-link">资源</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/pages/12df8ace52d493f6/" class="nav-link">Vue资源</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/vdoingBlog/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vdoingBlog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/vdoingBlog/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/pasregret/vdoingBlog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>java</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vdoingBlog/pages/7fae73/" class="sidebar-link">java测试</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>spring</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>问题记录</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>高可用</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"> <div class="theme-vdoing-wrapper"><div class="articleInfo-wrap" data-v-f6108aee><div class="articleInfo" data-v-f6108aee><ul class="breadcrumbs" data-v-f6108aee><li data-v-f6108aee><a href="/vdoingBlog/" title="首页" class="iconfont icon-home router-link-active" data-v-f6108aee></a></li> <li data-v-f6108aee><a href="/vdoingBlog/engineer" title="后端-目录页" data-v-f6108aee>后端</a></li> <!----></ul> <div class="info" data-v-f6108aee><div title="作者" class="author iconfont icon-touxiang" data-v-f6108aee><a href="https://github.com/pasregret" target="_blank" title="作者" class="beLink" data-v-f6108aee>時念</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-f6108aee><a href="javascript:;" data-v-f6108aee>2024-03-26</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">
          redis-master-slave
        </h1> <div class="theme-vdoing-content content__default"><h1 id="redis-主从架构"><a href="#redis-主从架构" class="header-anchor">#</a> Redis 主从架构</h1> <p>单机的 Redis，能够承载的 QPS 大概就在上万到几万不等。对于缓存来说，一般都是用来支撑<strong>读高并发</strong>的。因此架构做成主从(master-slave)架构，一主多从，主负责写，并且将数据复制到其它的 slave 节点，从节点负责读。所有的<strong>读请求全部走从节点</strong>。这样也可以很轻松实现水平扩容，<strong>支撑读高并发</strong>。</p> <p><img src="data:image/png;base64,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" alt="Redis-master-slave"></p> <p>Redis replication -&gt; 主从架构 -&gt; 读写分离 -&gt; 水平扩容支撑读高并发</p> <h2 id="redis-replication-的核心机制"><a href="#redis-replication-的核心机制" class="header-anchor">#</a> Redis replication 的核心机制</h2> <ul><li>Redis 采用<strong>异步方式</strong>复制数据到 slave 节点，不过 Redis2.8 开始，slave node 会周期性地确认自己每次复制的数据量；</li> <li>一个 master node 是可以配置多个 slave node 的；</li> <li>slave node 也可以连接其他的 slave node；</li> <li>slave node 做复制的时候，不会 block master node 的正常工作；</li> <li>slave node 在做复制的时候，也不会 block 对自己的查询操作，它会用旧的数据集来提供服务；但是复制完成的时候，需要删除旧数据集，加载新数据集，这个时候就会暂停对外服务了；</li> <li>slave node 主要用来进行横向扩容，做读写分离，扩容的 slave node 可以提高读的吞吐量。</li></ul> <p>注意，如果采用了主从架构，那么建议必须<strong>开启</strong> master node 的<a href="/vdoingBlog/docs/high-concurrency/redis-persistence.html">持久化</a>，不建议用 slave node 作为 master node 的数据热备，因为那样的话，如果你关掉 master 的持久化，可能在 master 宕机重启的时候数据是空的，然后可能一经过复制， slave node 的数据也丢了。</p> <p>另外，master 的各种备份方案，也需要做。万一本地的所有文件丢失了，从备份中挑选一份 rdb 去恢复 master，这样才能<strong>确保启动的时候，是有数据的</strong>，即使采用了后续讲解的<a href="/vdoingBlog/docs/high-concurrency/redis-sentinel.html">高可用机制</a>，slave node 可以自动接管 master node，但也可能 sentinel 还没检测到 master failure，master node 就自动重启了，还是可能导致上面所有的 slave node 数据被清空。</p> <h2 id="redis-主从复制的核心原理"><a href="#redis-主从复制的核心原理" class="header-anchor">#</a> Redis 主从复制的核心原理</h2> <p>当启动一个 slave node 的时候，它会发送一个 <code>PSYNC</code> 命令给 master node。</p> <p>如果这是 slave node 初次连接到 master node，那么会触发一次 <code>full resynchronization</code> 全量复制。此时 master 会启动一个后台线程，开始生成一份 <code>RDB</code> 快照文件，同时还会将从客户端 client 新收到的所有写命令缓存在内存中。 <code>RDB</code> 文件生成完毕后， master 会将这个 <code>RDB</code> 发送给 slave，slave 会先<strong>写入本地磁盘，然后再从本地磁盘加载到内存</strong>中，接着 master 会将内存中缓存的写命令发送到 slave，slave 也会同步这些数据。slave node 如果跟 master node 有网络故障，断开了连接，会自动重连，连接之后 master node 仅会复制给 slave 部分缺少的数据。</p> <p><img src="data:image/png;base64,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" alt="Redis-master-slave-replication"></p> <h3 id="主从复制的断点续传"><a href="#主从复制的断点续传" class="header-anchor">#</a> 主从复制的断点续传</h3> <p>从 Redis2.8 开始，就支持主从复制的断点续传，如果主从复制过程中，网络连接断掉了，那么可以接着上次复制的地方，继续复制下去，而不是从头开始复制一份。</p> <p>master node 会在内存中维护一个 backlog，master 和 slave 都会保存一个 replica offset 还有一个 master run id，offset 就是保存在 backlog 中的。如果 master 和 slave 网络连接断掉了，slave 会让 master 从上次 replica offset 开始继续复制，如果没有找到对应的 offset，那么就会执行一次 <code>resynchronization</code> 。</p> <blockquote><p>如果根据 host+ip 定位 master node，是不靠谱的，如果 master node 重启或者数据出现了变化，那么 slave node 应该根据不同的 run id 区分。</p></blockquote> <h3 id="无磁盘化复制"><a href="#无磁盘化复制" class="header-anchor">#</a> 无磁盘化复制</h3> <p>master 在内存中直接创建 <code>RDB</code> ，然后发送给 slave，不会在自己本地落地磁盘了。只需要在配置文件中开启 <code>repl-diskless-sync yes</code> 即可。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>repl-diskless-sync <span class="token function">yes</span>

<span class="token comment"># 等待 5s 后再开始复制，因为要等更多 slave 重新连接过来</span>
repl-diskless-sync-delay <span class="token number">5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="过期-key-处理"><a href="#过期-key-处理" class="header-anchor">#</a> 过期 key 处理</h3> <p>slave 不会过期 key，只会等待 master 过期 key。如果 master 过期了一个 key，或者通过 LRU 淘汰了一个 key，那么会模拟一条 del 命令发送给 slave。</p> <h2 id="复制的完整流程"><a href="#复制的完整流程" class="header-anchor">#</a> 复制的完整流程</h2> <p>slave node 启动时，会在自己本地保存 master node 的信息，包括 master node 的 <code>host</code> 和 <code>ip</code> ，但是复制流程没开始。</p> <p>slave node 内部有个定时任务，每秒检查是否有新的 master node 要连接和复制，如果发现，就跟 master node 建立 socket 网络连接。然后 slave node 发送 <code>ping</code> 命令给 master node。如果 master 设置了 requirepass，那么 slave node 必须发送 masterauth 的口令过去进行认证。master node <strong>第一次执行全量复制</strong>，将所有数据发给 slave node。而在后续，master node 持续将写命令，异步复制给 slave node。</p> <p><img src="/vdoingBlog/assets/img/redis-master-slave-replication-detail.0b823cd3.png" alt="Redis-master-slave-replication-detail"></p> <h3 id="全量复制"><a href="#全量复制" class="header-anchor">#</a> 全量复制</h3> <ul><li>master 执行 bgsave ，在本地生成一份 rdb 快照文件。</li> <li>master node 将 rdb 快照文件发送给 slave node，如果 rdb 复制时间超过 60 秒（repl-timeout），那么 slave node 就会认为复制失败，可以适当调大这个参数(对于千兆网卡的机器，一般每秒传输 100MB，6G 文件，很可能超过 60s)</li> <li>master node 在生成 rdb 时，会将所有新的写命令缓存在内存中，在 slave node 保存了 rdb 之后，再将新的写命令复制给 slave node。</li> <li>如果在复制期间，内存缓冲区持续消耗超过 64MB，或者一次性超过 256MB，那么停止复制，复制失败。</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>client-output-buffer-limit slave 256MB 64MB <span class="token number">60</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>slave node 接收到 rdb 之后，清空自己的旧数据，然后重新加载 rdb 到自己的内存中。注意，在清空旧数据之前，slave node 依然会<strong>基于旧的数据版本</strong>对外提供服务。</li> <li>如果 slave node 开启了 AOF，那么会立即执行 BGREWRITEAOF，重写 AOF。</li></ul> <h3 id="增量复制"><a href="#增量复制" class="header-anchor">#</a> 增量复制</h3> <ul><li>如果全量复制过程中，master-slave 网络连接断掉，那么 slave 重新连接 master 时，会触发增量复制。</li> <li>master 直接从自己的 backlog 中获取部分丢失的数据，发送给 slave node，默认 backlog 就是 1MB。</li> <li>master 就是根据 slave 发送的 psync 中的 offset 来从 backlog 中获取数据的。</li></ul> <h3 id="heartbeat"><a href="#heartbeat" class="header-anchor">#</a> heartbeat</h3> <p>主从节点互相都会发送 heartbeat 信息。</p> <p>master 默认每隔 10 秒发送一次 heartbeat，slave node 每隔 1 秒发送一个 heartbeat。</p> <h3 id="异步复制"><a href="#异步复制" class="header-anchor">#</a> 异步复制</h3> <p>master 每次接收到写命令之后，先在内部写入数据，然后异步发送给 slave node。</p> <h2 id="redis-如何才能做到高可用"><a href="#redis-如何才能做到高可用" class="header-anchor">#</a> Redis 如何才能做到高可用</h2> <p>如果系统在 365 天内，有 99.99% 的时间，都是可以哗哗对外提供服务的，那么就说系统是高可用的。</p> <p>一个 slave 挂掉了，是不会影响可用性的，还有其它的 slave 在提供相同数据下的相同的对外的查询服务。</p> <p>但是，如果 master node 死掉了，会怎么样？没法写数据了，写缓存的时候，全部失效了。slave node 还有什么用呢，没有 master 给它们复制数据了，系统相当于不可用了。</p> <p>Redis 的高可用架构，叫做 <code>failover</code> <strong>故障转移</strong>，也可以叫做主备切换。</p> <p>master node 在故障时，自动检测，并且将某个 slave node 自动切换为 master node 的过程，叫做主备切换。这个过程，实现了 Redis 的主从架构下的高可用。</p> <p>后面会详细说明 Redis <a href="/vdoingBlog/docs/high-concurrency/redis-sentinel.html">基于哨兵的高可用性</a>。</p></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/pasregret/vdoingBlog/edit/master/docs/02.后端/high-concurrency/redis-master-slave.md" target="_blank" rel="noopener noreferrer">编辑</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2024/03/26, 9:03:00</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <div class="article-list"><div class="article-title"><a href="/vdoingBlog/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/vdoingBlog/pages/bc52b9/"><div>database-shard-dynamic-expand</div></a> <span>03-26</span></dt></dl><dl><dd>02</dd> <dt><a href="/vdoingBlog/pages/7d465c/"><div>README</div></a> <span>03-26</span></dt></dl><dl><dd>03</dd> <dt><a href="/vdoingBlog/pages/b3459f/"><div>database-shard-global-id-generate</div></a> <span>03-26</span></dt></dl> <dl><dd></dd> <dt><a href="/vdoingBlog/archives/" class="more">更多文章&gt;</a></dt></dl></div></div> </main></div> <div class="footer"><div class="icons"><a href="https://msg.cnblogs.com/send/pasregret" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://blog.csdn.net/qq_17589751?type=blog" title="CSDN" target="_blank" class="iconfont icon-csdn"></a><a href="https://github.com/pasregret" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=2507037283" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
     | Copyright © 2019-2024
    <span>時念 | <a href="https://github.com/pasregret/vdoingBlog/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/vdoingBlog/assets/js/app.b9445f3d.js" defer></script><script src="/vdoingBlog/assets/js/2.6f6622d0.js" defer></script><script src="/vdoingBlog/assets/js/3.2637abc7.js" defer></script><script src="/vdoingBlog/assets/js/10.f47bb344.js" defer></script>
  </body>
</html>